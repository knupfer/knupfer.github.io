<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Kriterien</a>
<ul>
<li><a href="#sec-1-1">1.1. Informationsgehalt in KoMus</a>
<ul>
<li><a href="#sec-1-1-1">1.1.1. Durchschnittlicher Schüler</a></li>
<li><a href="#sec-1-1-2">1.1.2. Vierdimensional</a></li>
<li><a href="#sec-1-1-3">1.1.3. n-Dimensional</a>
<ul>
<li><a href="#sec-1-1-3-1">1.1.3.1. Probleme</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-2">2. Umsetzung</a>
<ul>
<li><a href="#sec-2-1">2.1. Programmierung</a>
<ul>
<li><a href="#sec-2-1-1">2.1.1. Initialisierung</a></li>
<li><a href="#sec-2-1-2">2.1.2. Nichtadaptiv</a>
<ul>
<li><a href="#sec-2-1-2-1">2.1.2.1. Unbedingte und bedingte Entropie in normaler Reihenfolge</a></li>
<li><a href="#sec-2-1-2-2">2.1.2.2. Bedingte, sortierte Entropie</a></li>
<li><a href="#sec-2-1-2-3">2.1.2.3. Durchschnittlich bedingtsortierte Entropie</a></li>
</ul>
</li>
<li><a href="#sec-2-1-3">2.1.3. Adaptiv</a>
<ul>
<li><a href="#sec-2-1-3-1">2.1.3.1. Individuellbedingtsortierte Entropie</a></li>
<li><a href="#sec-2-1-3-2">2.1.3.2. Individuellbedingtsortierte Entropie mit Trennschärfe</a></li>
<li><a href="#sec-2-1-3-3">2.1.3.3. Individuellbedingtsortierte Entropie mit Prädiktion</a></li>
</ul>
</li>
<li><a href="#sec-2-1-4">2.1.4. Experimenteller Code</a></li>
<li><a href="#sec-2-1-5">2.1.5. Schlussberechnungen</a></li>
<li><a href="#sec-2-1-6">2.1.6. Formel für die Modellanpassung</a></li>
<li><a href="#sec-2-1-7">2.1.7. Benchmark</a></li>
<li><a href="#sec-2-1-8">2.1.8. Entropiegrafik</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<p>
Beim adaptiven Testen werden die Möglichkeiten einer computerbasierten Testung in erweitertem Maße ausgenutzt.
Es wird innerhalb der Testung auf Grund der bereits beantworteten Fragen auf den Fähigkeitsgrad des Probanden geschätzt,
um ihm als nächstes eine Frage zu geben, die diesen reflektiert.
</p>


<div class="figure">
<p><img src="file:///images/adaptiveditaa.png" alt="adaptiveditaa.png" />
</p>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Kriterien</h2>
<div class="outline-text-2" id="text-1">
<p>
Wie genau die Frage ausgewählt wird hängt vornehmlich von den Zielen der Testung und den Nebenwirkungen, die man ggf. 
vermeiden möchte, ab. So wäre eine Frage, die der Proband mit einer Chance von 50% lösen kann ideal im Sinne eines 
Informationsgewinnes über den Probanden, da die Entropie maximal ist. 
</p>

<p>
Entropie stellt nicht nur Chaos, sondern auch Informationsdichte nach Shannon dar 
(vgl. <a href="http://de.wikipedia.org/wiki/Entropie_%28Informationstheorie%29">Wikipedia</a>).
Die folgende Formel ergiebt die Entropie eines Ereignisses. Hierbei ist \(n\) die Anzahl der Möglichkeiten und \(p_i\) 
die jeweiligen Wahrscheinlichkeiten dieser (sich ausschließender) Möglichkeiten.
</p>

<p>
$$ H = - \sum_{i=1}^n p_i \cdot \log_2{p_i} $$
</p>

<p>
Betrachten wir ein binäres System, also nur Fragen die entweder vollständig falsch oder vollständig richtig beantwortet
werden können, so haben wir \(n = 2\) und \(p_2 = 1 - p_1\).
</p>

<p>
$$ H_2 = - p \cdot \log_2{p} - (1 - p) \cdot \log_2(1 - p) $$
</p>

<p>
Hieraus ergiebt sich, dass der Informationsgewinn bei \(p = .5\) (im binären) maximal ist, da die Funktion symmetrisch ist und bei
\(p = 0\) auf beiden Seiten \(0\) ergibt.
</p>

<p>
$$ H_{max} = - 0.5 \cdot \log_2{0.5} - 0.5 \cdot \log_2{0.5} = 1 \mathrm{bit} $$
</p>

<p>
Hierbei ist \(bit\) die übliche Einheit des Informationsgehaltes, auf Grund des \(\log_2\). Es kann also ein Informationsgehalt
von 8 bit mit Hilfe eines bytes dargestellt werden, sprich mit 8 Nullen oder Einsen (z.B. 10101010).
</p>


<div class="figure">
<p><img src="file:///images/entropie.png" alt="entropie.png" />
</p>
</div>

<p>
Mit der Formel für tatsächliche und für maximale Entropie kann die Redundanz ausgerechnet werden, welche in einer 
Testkonstruktion als Indikator für das Potential der Verbesserung durch ein adaptives Testverfahren benutzt werden kann.
</p>

<p>
$$ R = H_{max} - H $$
</p>

<p>
Somit kann im binären ein Test im idealfall um \(R\) Fragen verkleinert werden, ohne an Informationen einzubüßen. 
Befinden sich im Test auch Fragen, die nicht binär sind, so verändert sich die Situation ein wenig.
Die Entropie wird stets maximal bei gleichen Wahrscheinlichkeiten. Gibt es nun bei einer Frage z.B. 0, 1, 2 oder 3 Punkte
gibt es eine maximale Entropie von \(H_{max} = - \log_2{0.25} = 2 \mathrm{bit}\). Somit kann man einen Test auch um \(R/2\) solcher
Fragen ohne Informationsverlust verkleinern.
</p>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Informationsgehalt in KoMus</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Im August diesen Jahres habe ich mit Teilen des KoMus-Testes für musikalische Kompetenz eine empirische Studie
durchgeführt. Der KoMus-Test liegt in einem nicht adaptiven Format vor.
</p>

<p>
Interessant ist nun, die Überlegung, wieviel der Test von einer Überführung in einen adaptiven Test profitieren würde.
</p>
</div>

<div id="outline-container-sec-1-1-1" class="outline-4">
<h4 id="sec-1-1-1"><span class="section-number-4">1.1.1</span> Durchschnittlicher Schüler</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
Der Simplizität halber können wir annehmen, dass ein Schüler genau die durchschnittlichen Lösungswahrscheinlichkeiten
für ein Item aufweist.
</p>

<p>
So muss man nur die Entropie mit den klassischen Itemschwierigkeiten der Items berechnen:
</p>

<p>
$$ H = \sum_{i=1}^n(- P_i \cdot \log_2{P_i} - (1 - P_i) \cdot \log_2(1 - P_i)) $$
</p>

<p>
Hierbei ist \(P_i\) die klassische Itemschwierigkeit des Items \(i\) und \(n\) die Anzahl der Items. Ferner nimmt diese Formel
nur dichotome Items an.
</p>
</div>
</div>
<div id="outline-container-sec-1-1-2" class="outline-4">
<h4 id="sec-1-1-2"><span class="section-number-4">1.1.2</span> Vierdimensional</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
Die Entropie ist jedoch eigentlich noch niedriger, wenn man die Schwierigkeiten adaptiv berechnet. Es handelt sich aber
immernoch um einen nicht adaptiven Test mit fester Reihenfolge. Es wird nur eine spezialform der Entropie, die bedingte
Entropie, benutzt (vgl. <a href="http://de.wikipedia.org/wiki/Bedingte_Entropie">Wikipedia</a>).
</p>

<p>
Um die bedingte Lösungschance und somit auch die bedingte Entropie zu berechnen, werden alle Items der selben Dimension
einer logistisch binären Regression verwendet um die individuell Itemschwierigkeit eines Items der gleichen Dimension zu
berechnen.
</p>

<p>
$$ H = \sum_{D=1}^4(\sum_{i=1}^{n(D)}(- R \cdot \log_2{R}) - (1 - R) \cdot \log_2(1- R))$$
$$ R = Reg_2(P_{ivD}|\sum_{m=1}^{i(D)-1}P_{vmD}) $$
</p>

<p>
Hierbei ist \(Reg_2(a|b)\) die binärlogistische Regression mit der AV \(a\) und den UV \(b\).
</p>
</div>
</div>
<div id="outline-container-sec-1-1-3" class="outline-4">
<h4 id="sec-1-1-3"><span class="section-number-4">1.1.3</span> n-Dimensional</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
Das obige Modell nimmt jedoch an, dass die einzelnen Dimensionen nicht korrelieren und somit Itemantworten einer Dimension 
keine Information (also Entropiesenkung) über andere Dimensionen zulassen.
</p>

<p>
Dies ist aber eine nicht notwendige Einschränkung, die die Berechnung nicht nur weniger effektiv, sondern auch
komplizierter macht.
</p>

<p>
Berücksichtigen wir unabhängig von der Dimensionszugehörigkeit einfach alle bereits beantworteten Items, die einen
signifikanten Einfluss auf die Frage haben, haben wir im Endeffekt ein n-dimensionales Modell, wobei \(n\) die Anzahl der
Fragen ist.
</p>

<p>
$$ H = \sum_{i=1}^n(- R \cdot \log_2{R} - (1 - R) \cdot \log_2(1 - R)) $$
$$ R = Reg_2(P_{iv}|\sum_{m=1}^{i-1}P_{vm}) $$
</p>
</div>

<div id="outline-container-sec-1-1-3-1" class="outline-5">
<h5 id="sec-1-1-3-1"><span class="section-number-5">1.1.3.1</span> Probleme</h5>
<div class="outline-text-5" id="text-1-1-3-1">
<p>
Mögliche Probleme dieser Methode sind fehlende Datensätze, da die binärlogistische Regression normalerweise alle Fälle
ausschließt, die auch nur bei einem der UV keinen Wert hat. Durch den maßgeschneiderten Testweg ist es bei einem 
Itempool, der nicht komplett erschöpft wird, unmöglich diese Regression so durchzuführen. Dementsprechend müssen
andere Methoden gewählt werden, um mit fehlenden Daten umzugehen.
</p>

<p>
Eine Möglichkeit wäre, nicht vorhandene Antworten in den Datensätzen zu simulieren. Diese Simulation würde von den Items
die am sichersten geschätzt werden können zu den Items, die schwer geschätzt werden können stattfinden.
</p>

<p>
Der Grund hierfür liegt daran, dass bei einer sehr sicheren Schätzung der Entropiegehalt sich nur wenig ändert, 
aber es gleich viel mehr Personen gibt, die seriös für schwerere Schätzungen verwendet werden können, was diese
Schätzungen erleichtert.
</p>

<p>
Die Simulation sollte nach jeder Testung durchgeführt werden, um die Simulation mehr und mehr zu verbessern. Das dieses
Verfahren direkt einen Nutzen erbringt, sollte daran sichtbar sein, dass die Lösungen der alten Datensätze immer besser
retrospektiv vorhergesagt werden können und somit davon außgegangen werden kann, dass auch bei aktuellen Testungen
die Schätzungen besser sind und somit effektiver gemessen werden kann.
</p>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Umsetzung</h2>
<div class="outline-text-2" id="text-2">
<p>
Die Umsetzung wurde mit R bewerkstelligt. Hier traten auch schnell Probleme auf. So wurde die Rechenzeit bei etwas komplizierteren Modellen sehr lang,
was natürlich auch an meinem Computer liegt. Nichts desto trotz ergaben sich Situationen, in denen der Computer 5 Tage lang rechnen hätte müssen.
</p>

<p>
In anderen Situationen wurde das komplette Ram des Computers aufgezehrt usw.
</p>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Programmierung</h3>
<div class="outline-text-3" id="text-2-1">
</div><div id="outline-container-sec-2-1-1" class="outline-4">
<h4 id="sec-2-1-1"><span class="section-number-4">2.1.1</span> Initialisierung</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
Für alle nachfolgenden Berechnungen habe ich immer dieses Skript benutzt, um grundlegende Dinge, wie Funktionen, die an vielen Stellen benötigt werden, die
Daten usw. bereitgestellt werden. Ferner werden, wo möglich, Berechnungen mit dieser Initialisierung parallelisiert.
</p>

<div class="org-src-container">

<pre class="src src-R" id="statistic"><span style="color: #a2cd5a;">require</span>(MASS)
<span style="color: #a2cd5a;">library</span>(multicore)
<span style="color: #a2cd5a;">library</span>(foreach)
<span style="color: #a2cd5a;">library</span>(doMC)
registerDoMC(3)

calculationtime <span style="color: #a2cd5a;">&lt;-</span> proc.time()
komus = read.table(<span style="color: #deb887;">"data/data_komus_bin2.dat"</span>,header=<span style="color: #98f5ff;">TRUE</span>) 
komusmult = data.frame(read.table(<span style="color: #deb887;">"data/komus.csv"</span>,header=<span style="color: #98f5ff;">TRUE</span>, sep=<span style="color: #deb887;">','</span>))
multifragen = array(which(sapply(komusmult, max) &gt; 1))
multifragenalt = multifragen
komusmult[multifragen] = lapply(komusmult[multifragen],factor)

FUN.EntropieMC = <span style="color: #00bfff;">function</span>(x) {<span style="color: #00bfff;">return</span>(rowSums(-x*log(x+0.00000001, 2)))}
FUN.EntropieMC.IND = <span style="color: #00bfff;">function</span>(x) {<span style="color: #00bfff;">return</span>(sum(-x*log(x+0.00000001, 2)))}
FUN.Entropie = <span style="color: #00bfff;">function</span>(x) {<span style="color: #00bfff;">return</span>(-x*log(x+0.000001, 2)-(1-x)*log(1-x+0.00001, 2))}
FUN.Chances = <span style="color: #00bfff;">function</span>(x) {
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (length(multifragen) &gt; 0) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   x[-multifragen] = lapply(x[-multifragen], predict, type=<span style="color: #deb887;">"response"</span>)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   x[multifragen] = lapply(x[multifragen], predict, type=<span style="color: #deb887;">"probs"</span>)
<span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   x = lapply(x, predict, type=<span style="color: #deb887;">"response"</span>)
<span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">return</span>(x)
}
FUN.Chances.IND = <span style="color: #00bfff;">function</span>(x,y) {
<span style="background-color: #252530;"> </span>   x[-multifragen] = lapply(x[-multifragen], predict, data = komusmult[y,], type=<span style="color: #deb887;">"response"</span>)
<span style="background-color: #252530;"> </span>   x[multifragen] = lapply(x[multifragen], predict, data = komusmult[y,], type=<span style="color: #deb887;">"probs"</span>)
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">return</span>(x)
}
FUN.Entropietemp = <span style="color: #00bfff;">function</span>(x) {
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (length(multifragen) &gt; 0) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   x[multifragen] = lapply(x[multifragen], FUN.EntropieMC)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   x[-multifragen] =lapply(x[-multifragen], FUN.Entropie)
<span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   x =lapply(x, FUN.Entropie)
<span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   x = simplify2array(x)
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">return</span>(x)
}
FUN.Entropietemp.IND = <span style="color: #00bfff;">function</span>(x) {
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (length(multifragen) &gt; 0) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   x[multifragen] = lapply(x[multifragen], FUN.EntropieMC.IND)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   x[-multifragen] =lapply(x[-multifragen], FUN.Entropie)
<span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   x =lapply(x, FUN.Entropie)
<span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   x = simplify2array(x)
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">return</span>(x)
}



FUN.EntroMC = <span style="color: #00bfff;">function</span>(funmultifragen, fundata, funmod) {

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (length(funmultifragen) == 1) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chances = lapply(funmod, predict, fundata, type=<span style="color: #deb887;">"response"</span>)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = chances
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = lapply(chances, FUN.Entropie)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = simplify2array(Entropietemp)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   funmultifragen = funmultifragen[2:length(funmultifragen)]
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chances = funmod
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chances[-funmultifragen] = lapply(funmod[-funmultifragen], predict, fundata, type=<span style="color: #deb887;">"response"</span>)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chances[funmultifragen] = lapply(funmod[funmultifragen], predict, fundata, type=<span style="color: #deb887;">"probs"</span>)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = chances

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp[funmultifragen] = lapply(chances[funmultifragen], FUN.EntropieMC.IND)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp[-funmultifragen] = lapply(chances[-funmultifragen], FUN.Entropie)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = simplify2array(Entropietemp)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="color: #00bfff;">return</span>(Entropietemp)
}






Entropie = <span style="color: #98f5ff;">NULL</span>
chances = <span style="color: #98f5ff;">NULL</span>
fitting = <span style="color: #98f5ff;">NULL</span>
modell = <span style="color: #98f5ff;">NULL</span>
summe = data.frame()
<span style="color: #7f7f7f;">############</span>
items = length(komusmult)
<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">persons = length(komusmult[,1])</span>
<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">items = 50</span>
persons = 3
<span style="color: #7f7f7f;">############</span>

EEE = data.frame(matrix(ncol = 1, nrow = items+1))
SumSD = data.frame(matrix(ncol = 1, nrow = items+1))
RestEntropie = data.frame(matrix(ncol = 1, nrow = items+1))
RestEntropieSD = data.frame(matrix(ncol = 1, nrow = items+1))
names(EEE) = <span style="color: #deb887;">'kill'</span>
names(SumSD) = <span style="color: #deb887;">'kill'</span>
names(RestEntropie) = <span style="color: #deb887;">'kill'</span>
names(RestEntropieSD) = <span style="color: #deb887;">'kill'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-1-2" class="outline-4">
<h4 id="sec-2-1-2"><span class="section-number-4">2.1.2</span> Nichtadaptiv</h4>
<div class="outline-text-4" id="text-2-1-2">
</div><div id="outline-container-sec-2-1-2-1" class="outline-5">
<h5 id="sec-2-1-2-1"><span class="section-number-5">2.1.2.1</span> Unbedingte und bedingte Entropie in normaler Reihenfolge</h5>
<div class="outline-text-5" id="text-2-1-2-1">
<p>
Dieser verhältnismäßig simple Code berechnet die Entropie über die klassische Itemschwierigkeit und die Entropie über die durch binärlogistische
Regressionen vorhergesagte Itemschwierigkeit in der ursprünglichen Reihenfolge.
Zudem wird bei zweiter Berechnung noch angegeben, wie viel Restentropie nach jeder Antwort noch zu erwarten ist.
</p>
<div class="org-src-container">

<pre class="src src-R" id="statistic1"><span style="background-color: #252530;"> </span>   modell = <span style="color: #98f5ff;">NULL</span>

<span style="background-color: #252530;"> </span>   multifragen = multifragen[multifragen &lt;= items]
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (1 %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   modell[[1]] = polr(reformulate(<span style="color: #deb887;">'1'</span>, names(komusmult[1])), data = komusmult)
<span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   modell[[1]] = glm(reformulate(<span style="color: #deb887;">'1'</span>, names(komusmult[1])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 2:items) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (i %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   modell[[i]] = polr(reformulate(names(komusmult[1:i-1]), names(komusmult[i])), data = komusmult)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   modell[[i]] = glm(reformulate(names(komusmult[1:i-1]), names(komusmult[i])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   fitting = modell
<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>
<span style="background-color: #252530;"> </span>   chances = FUN.Chances(fitting)

<span style="background-color: #252530;"> </span>   Entropietemp = FUN.Entropietemp(chances)

<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">### </span><span style="color: #7f7f7f;">Without relations ###</span>
<span style="background-color: #252530;"> </span>   fitting = lapply(fitting, update, ~ 1)
<span style="background-color: #252530;"> </span>   chances2 = FUN.Chances(fitting)

<span style="background-color: #252530;"> </span>   Entropietemp2 = FUN.Entropietemp(chances2)

<span style="background-color: #252530;"> </span>   multifragen = multifragenalt

fragen = <span style="color: #98f5ff;">NULL</span>
Restentropietemp = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 1:items) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp3 = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting3 = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (i == length(komusmult)) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp[[i]] = Restentropietemp[[1]]*0
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fragen = 1:i
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   multifragen = which(names(komusmult[-fragen]) %<span style="color: #00bfff;">in</span>% names(komusmult[multifragenalt]))

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (j <span style="color: #00bfff;">in</span> 1:length(komusmult[-fragen])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (j %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting3[[j]] = polr(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting3[[j]] = glm(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chances3 = FUN.Chances(fitting3)

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp3 = FUN.Entropietemp(chances3)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp[[i]] = rowSums(Entropietemp3)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   Restentropietemp = simplify2array(Restentropietemp)

<span style="background-color: #252530;"> </span>   RestEntropie$bedunsort = c(0,colMeans(Restentropietemp))
<span style="background-color: #252530;"> </span>   RestEntropieSD$bedunsort = c(0,apply(Restentropietemp, 2, sd))



<span style="background-color: #252530;"> </span>   SumSDtemp = sd(Entropietemp[,1])
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 2:length(Entropietemp[1,])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   SumSDtemp[i] = sd(rowSums(Entropietemp[,1:i]))
<span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   SumSD$bedunsort = c(0,SumSDtemp)

<span style="background-color: #252530;"> </span>   EEE$bedunsort = c(0,colMeans(Entropietemp))
<span style="background-color: #252530;"> </span>   EEE$unbedunsort = c(0,colMeans(Entropietemp2))
<span style="background-color: #252530;"> </span>   EEE$unbedsort = c(0,sort(colMeans(Entropietemp2), decreasing =<span style="color: #98f5ff;">TRUE</span>))
<span style="background-color: #252530;"> </span>   Entropietemp2 = data.frame(Entropietemp2)
<span style="background-color: #252530;"> </span>   names(Entropietemp2) = names(komusmult[1:length(Entropietemp2)])<span style="background-color: #252530;"> </span>   
EEE
RestEntropie
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-1-2-2" class="outline-5">
<h5 id="sec-2-1-2-2"><span class="section-number-5">2.1.2.2</span> Bedingte, sortierte Entropie</h5>
<div class="outline-text-5" id="text-2-1-2-2">
<p>
Hier werden die Items schlicht nach dem durchschnittlichen Entropiegehalt sortiert, bevor die bedingte Entropie mit Regressionen berechnet wird.
Dies verbessert die resultierende Kurve schon um einiges, der Entropiegewinn ist so tendenziell am Anfang weit höher als am Ende, trotz dass gleich
viel Entropie innerhalb des kompletten Durchlaufes ermittelt wurde.
</p>
<div class="org-src-container">

<pre class="src src-R" id="statistic2">modell = <span style="color: #98f5ff;">NULL</span>
chances = <span style="color: #98f5ff;">NULL</span>
fitting = <span style="color: #98f5ff;">NULL</span>

<span style="color: #7f7f7f;">############## </span><span style="color: #7f7f7f;">sortierte Reihenfolge</span>
<span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 1:items) {
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (i %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   modell[[i]] = polr(reformulate(<span style="color: #deb887;">'1'</span>, names(komusmult[i])), data = komusmult)
<span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   modell[[i]] = glm(reformulate(<span style="color: #deb887;">'1'</span>, names(komusmult[i])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   }
}

chances = FUN.Chances(modell)
Entropietemp = FUN.Entropietemp(chances)
Entropietemp = data.frame(Entropietemp)
names(Entropietemp) = names(komusmult[1:length(Entropietemp)])
komus2 = komusmult[c(names(sort(colMeans(Entropietemp), decreasing=<span style="color: #98f5ff;">TRUE</span>)))]
<span style="color: #7f7f7f;">#########</span>

names(sort(colMeans(Entropietemp), decreasing=<span style="color: #98f5ff;">TRUE</span>))
multifragen.alt = multifragen
multifragen.alt
multifragen = which(names(komus2) %<span style="color: #00bfff;">in</span>% names(komusmult[multifragen.alt]))
modell = <span style="color: #98f5ff;">NULL</span>
fitting = <span style="color: #98f5ff;">NULL</span>
chances = <span style="color: #98f5ff;">NULL</span>

<span style="color: #00bfff;">if</span> (1 %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   modell[[1]] = polr(reformulate(<span style="color: #deb887;">'1'</span>, names(komus2[1])), data = komus2)
} <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   modell[[1]] = glm(reformulate(<span style="color: #deb887;">'1'</span>, names(komus2[1])), data = komus2, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
}

<span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 2:items) {
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (i %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   modell[[i]] = polr(reformulate(names(komus2[1:i-1]), names(komus2[i])), data = komus2)
<span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   modell[[i]] = glm(reformulate(names(komus2[1:i-1]), names(komus2[i])), data = komus2, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   }
}

fitting = modell
<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>
chances = FUN.Chances(fitting)
<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">chances[-multifragen] = mclapply(fitting[-multifragen], predict, type="response")</span>
<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">chances[multifragen] = mclapply(fitting[multifragen], predict, type="probs")</span>

<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">Entropietemp = fitting</span>
Entropietemp = FUN.Entropietemp(chances)
<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">Entropietemp[multifragen] = lapply(chances[multifragen], FUN.EntropieMC)</span>
<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">Entropietemp[-multifragen] =lapply(chances[-multifragen], FUN.Entropie)</span>
<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">Entropietemp = simplify2array(Entropietemp)</span>

SumSDtemp = sd(Entropietemp[,1])
<span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 2:length(Entropietemp[1,])) {
<span style="background-color: #252530;"> </span>   SumSDtemp[i] = sd(rowSums(Entropietemp[,1:i]))
}

SumSD$sortbed = c(0,SumSDtemp)

EEE$sortbed = c(0,colMeans(Entropietemp))

multifragen = multifragen.alt
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-1-2-3" class="outline-5">
<h5 id="sec-2-1-2-3"><span class="section-number-5">2.1.2.3</span> Durchschnittlich bedingtsortierte Entropie</h5>
<div class="outline-text-5" id="text-2-1-2-3">
<p>
Dieses Verfahren ist bereits weit rechenintensiver, es wird nacheinander das Item ausgewählt, welches durchschnittlich die Entropie am meisten senkt.
Es wird also nach der Erfassung eines Items dieses miteinbezogen für kommende Regressionen. Insgesamt ist dies aber noch nicht individualisiert und
dementsprechen nicht adaptiv.
</p>
<div class="org-src-container">

<pre class="src src-R" id="statistic3">fragen = <span style="color: #98f5ff;">NULL</span>
modell = <span style="color: #98f5ff;">NULL</span>
Restentropietemp = <span style="color: #98f5ff;">NULL</span>
multifragenalt = multifragen
<span style="color: #7f7f7f;">############## </span><span style="color: #7f7f7f;">sortierte Reihenfolge</span>
<span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 1:length(komusmult)) {
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (i %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[i]] = polr(reformulate(<span style="color: #deb887;">'1'</span>, names(komusmult[i])), data = komusmult)
<span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[i]] = glm(reformulate(<span style="color: #deb887;">'1'</span>, names(komusmult[i])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   }
}
<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">modell</span>
chances = FUN.Chances(fitting)

Entropietemp = FUN.Entropietemp(chances)

fragen = which(names(komusmult[which(colMeans(Entropietemp) == max(colMeans(Entropietemp)))[1]]) == names(komusmult))[1]
fragen
<span style="color: #7f7f7f;">#########</span>
modell[[1]] = fitting[[fragen]]

<span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 2:items) {
<span style="background-color: #252530;"> </span>   Entropietemp = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   fitting = <span style="color: #98f5ff;">NULL</span>

<span style="background-color: #252530;"> </span>   multifragen = which(names(komusmult[-fragen]) %<span style="color: #00bfff;">in</span>% names(komusmult[multifragenalt]))

<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (j <span style="color: #00bfff;">in</span> 1:length(komusmult[-fragen])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (j %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[j]] = polr(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[j]] = glm(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>
<span style="background-color: #252530;"> </span>   chances = FUN.Chances(fitting)

<span style="background-color: #252530;"> </span>   Entropietemp = FUN.Entropietemp(chances)
<span style="background-color: #252530;"> </span>   Restentropietemp[[i-1]] = rowSums(Entropietemp)

<span style="background-color: #252530;"> </span>   fragen = c(fragen, which(names(komusmult[-fragen][which(colMeans(Entropietemp) == max(colMeans(Entropietemp)))[1]]) == names(komusmult))[1])
<span style="background-color: #252530;"> </span>   modell[[i]] = fitting[[which(colMeans(Entropietemp) == max(colMeans(Entropietemp)))[1]]]
}

<span style="color: #00bfff;">if</span> (length(komusmult) == items) {
<span style="background-color: #252530;"> </span>   Restentropietemp[[items]] = Restentropietemp[[1]]*0
} <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   fitting = <span style="color: #98f5ff;">NULL</span>

<span style="background-color: #252530;"> </span>   multifragen = which(names(komusmult[-fragen]) %<span style="color: #00bfff;">in</span>% names(komusmult[multifragenalt]))

<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (j <span style="color: #00bfff;">in</span> 1:length(komusmult[-fragen])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (j %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[j]] = polr(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[j]] = glm(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>
<span style="background-color: #252530;"> </span>   chances = FUN.Chances(fitting)
<span style="background-color: #252530;"> </span>   Entropietemp = FUN.Entropietemp(chances)
<span style="background-color: #252530;"> </span>   Restentropietemp[[items]] = rowSums(Entropietemp)
}
multifragen = which(fragen %<span style="color: #00bfff;">in</span>% multifragenalt)

Restentropietemp = simplify2array(Restentropietemp)

chances = FUN.Chances(modell)
Entropietemp = FUN.Entropietemp(chances)

SumSDtemp = sd(Entropietemp[,1])
<span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 2:length(Entropietemp[1,])) {
SumSDtemp[i] = sd(rowSums(Entropietemp[,1:i]))
}

SumSD$durchschbedsort = c(0,SumSDtemp)
EEE$durchschbedsort = c(0,colMeans(Entropietemp))
RestEntropie$durchschbedsort = c(0,colMeans(Restentropietemp))
RestEntropieSD$durchschbedsort = c(0,apply(Restentropietemp, 2, sd))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-2-1-3" class="outline-4">
<h4 id="sec-2-1-3"><span class="section-number-4">2.1.3</span> Adaptiv</h4>
<div class="outline-text-4" id="text-2-1-3">
</div><div id="outline-container-sec-2-1-3-1" class="outline-5">
<h5 id="sec-2-1-3-1"><span class="section-number-5">2.1.3.1</span> Individuellbedingtsortierte Entropie</h5>
<div class="outline-text-5" id="text-2-1-3-1">
<p>
Hier wird das zuletzt genannte Verfahren individualisiert, was den Rechenaufwand in diesem Fall 319 mal höher macht. Das Ergebniss ist jedoch bereits
ein echt adaptiver Test. Somit ist die Entropiekurve nun auch viel stärker gekrümmt (hat also eine größere zweite Ableitung). Somit kann unter kleinem
Informationsverlust der Test stark verkürzt werden.
</p>

<p>
Ideal wäre ein Itempool, der nicht komplett erschöpft wird in einer Testung. Somit könnte man berechnen, wie lang ein nichtadaptiver im Vergleich zu einem 
gleichpräzisen adaptiven Test ist.
</p>
<div class="org-src-container">

<pre class="src src-R" id="statistic4"><span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">initializing</span>
Entropieall = <span style="color: #98f5ff;">NULL</span>
chances = <span style="color: #98f5ff;">NULL</span>
Restentropietemp = <span style="color: #98f5ff;">NULL</span>
fragen = <span style="color: #98f5ff;">NULL</span>
modell = <span style="color: #98f5ff;">NULL</span>
Restentropietemp = <span style="color: #98f5ff;">NULL</span>
multifragen = multifragenalt
fitting = <span style="color: #98f5ff;">NULL</span>

<span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">first item</span>
<span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 1:length(komusmult)) {
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (i %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[i]] = polr(reformulate(<span style="color: #deb887;">'1'</span>, names(komusmult[i])), data = komusmult)
<span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[i]] = glm(reformulate(<span style="color: #deb887;">'1'</span>, names(komusmult[i])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   }
}

chances = fitting
chances[-multifragen] = lapply(fitting[-multifragen], predict, komusmult[1,], type=<span style="color: #deb887;">"response"</span>)
chances[multifragen] = lapply(fitting[multifragen], predict, komusmult[1,], type=<span style="color: #deb887;">"probs"</span>)
Entropietemp = FUN.Entropietemp.IND(chances)
fragen = which(names(komusmult[which(Entropietemp == max(Entropietemp))[1]]) == names(komusmult))[1]

modell[[1]] = fitting[[fragen]]
frageninit = fragen
fitting = <span style="color: #98f5ff;">NULL</span>

<span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">multicorecalculation for every person</span>
Entropieall = simplify2array(foreach(k=1:persons) %dopar% {
<span style="background-color: #252530;"> </span>   fragen = frageninit
<span style="background-color: #252530;"> </span>   Restentropie = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 2:items) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chances = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   multifragen = c(0,which(names(komusmult[-fragen]) %<span style="color: #00bfff;">in</span>% names(komusmult[multifragenalt])))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (j <span style="color: #00bfff;">in</span> 1:length(komusmult[-fragen])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (j %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[j]] = polr(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[j]] = glm(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chances = fitting

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = FUN.EntroMC(multifragen,komusmult[k,], fitting)

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp[i-1] = sum(Entropietemp) <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">rest of entropie before this item</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fragen = c(fragen, which(names(komusmult[-fragen][which(Entropietemp == max(Entropietemp))[1]]) == names(komusmult))[1])
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   modell[[i]] = fitting[[which(Entropietemp == max(Entropietemp))[1]]]
<span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">calculation of last rest entropie</span>
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (length(komusmult) == items) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp[items] = 0
<span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   multifragen = 0
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   multifragen = c(0,which(names(komusmult[-fragen]) %<span style="color: #00bfff;">in</span>% names(komusmult[multifragenalt])))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (j <span style="color: #00bfff;">in</span> 1:length(komusmult[-fragen])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (j %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[j]] = polr(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[j]] = glm(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = FUN.EntroMC(multifragen,komusmult[k,], fitting)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp[items] = sum(Entropietemp)
<span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">calculation of the choosen modell</span>
<span style="background-color: #252530;"> </span>   multifragen = c(0,which(fragen %<span style="color: #00bfff;">in</span>% multifragenalt))

<span style="background-color: #252530;"> </span>   Entropietemp = FUN.EntroMC(multifragen,komusmult[k,], modell)
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">return</span>(c(Entropietemp, Restentropietemp))<span style="background-color: #252530;"> </span>   
})

Restentropietemp = (Entropieall[(items+1):(items*2),])
Entropieall = Entropieall[1:items,]

SumSDtemp = sd(Entropieall[1,])
<span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 2:length(Entropieall[,1])) {
<span style="background-color: #252530;"> </span>   SumSDtemp[i] = sd(colSums(Entropieall[1:i,]))
}

SumSD$indivbedsort = c(0,SumSDtemp)
EEE$indivbedsort = c(0,rowMeans(Entropieall))
RestEntropie$indivbedsort = c(0,rowMeans(Restentropietemp))
RestEntropieSD$indivbedsort = c(0,apply(Restentropietemp, 1, sd))

multifragen = multifragenalt
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-1-3-2" class="outline-5">
<h5 id="sec-2-1-3-2"><span class="section-number-5">2.1.3.2</span> Individuellbedingtsortierte Entropie mit Trennschärfe</h5>
<div class="outline-text-5" id="text-2-1-3-2">
<p>
Ein nicht gut gelungener Versuch, nicht nur die Entropie als Auswahlkriterium zu nehmen. Dies ist deswegen sinnvoll, da Items vorstellbar sind mit hoher
Entropie, die aber mit dem Test wenig zu tun haben (z.B. eine Frage nach der Schuhgröße hat vermutlich eine sehr hohe Entropie, hat aber vermutlich wenig
mit musikalischer Kompetenz zu tun). Somit macht das bisherige Verfahren die Annahme, dass der Itempool sehr gut konstruiert ist. Dementsprechend kann 
man das bisherige Verfahren sicher nicht als robust bezeichnen.
</p>
<div class="org-src-container">

<pre class="src src-R" id="statistic5">Entropieall = <span style="color: #98f5ff;">NULL</span>
chances = <span style="color: #98f5ff;">NULL</span>
beta = <span style="color: #98f5ff;">NULL</span>
Restentropietemp = <span style="color: #98f5ff;">NULL</span>
Entropietemp = <span style="color: #98f5ff;">NULL</span>
fitting = <span style="color: #98f5ff;">NULL</span>

<span style="color: #00bfff;">if</span> (!exists(<span style="color: #deb887;">"information"</span>)) {
<span style="background-color: #252530;"> </span>   information = simplify2array(foreach(m=1:length(komus)) %dopar% {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (n <span style="color: #00bfff;">in</span> 1:(length(komus)-1)) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   beta[[n]] = glm(reformulate(names(komus[m]), names(komus[-m][n])), data = komus, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chances = simplify2array(lapply(beta, predict, type=<span style="color: #deb887;">"response"</span>))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chancetemp = unlist(lapply(komus[m],mean))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = (-chances*log(chances,2)-(1-chances)*log(1-chances,2))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   information = sum(colMeans(Entropietemp)) + (-chancetemp*log(chancetemp,2)-(1-chancetemp)*log(1-chancetemp,2))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">return</span>(information)
<span style="background-color: #252530;"> </span>   })
<span style="background-color: #252530;"> </span>   information = -(information - sum(-colMeans(komus)*log(colMeans(komus),2)-(1-colMeans(komus))*log(1-colMeans(komus),2)))
}





<span style="color: #00bfff;">for</span> (j <span style="color: #00bfff;">in</span> 1:length(komus)) {
<span style="background-color: #252530;"> </span>   fitting[[j]] = glm(reformulate(<span style="color: #deb887;">'1'</span>, names(komus[j])), data = komus, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
}
<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>
chances = simplify2array(lapply(fitting, predict, komus[1,], type=<span style="color: #deb887;">"response"</span>))
Entropietemp = (-chances*log(chances,2)-(1-chances)*log(1-chances,2)) + (information)
frageninit = which(names(komus[which((Entropietemp) == max((Entropietemp)))[1]]) == names(komus))[1]



modell[[1]] = fitting[[which((Entropietemp) == max((Entropietemp)))[1]]]

Entropieall = simplify2array(foreach(k=1:persons) %dopar% {
<span style="background-color: #252530;"> </span>   fragen = frageninit
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 2:items) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (j <span style="color: #00bfff;">in</span> 1:length(komus[-fragen])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[j]] = glm(reformulate(names(komus[fragen]), names(komus[-fragen][j])), data = komus, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">TODO stimmt das so?</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chances = simplify2array(lapply(fitting, predict, komus[k,], type=<span style="color: #deb887;">"response"</span>))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp[i-1] = sum(-chances*log(chances,2)-(1-chances)*log(1-chances,2)) 
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = (-chances*log(chances,2)-(1-chances)*log(1-chances,2)) + (information[-fragen]*(1 - (length(fragen)+1)/items))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fragen = c(fragen, which(names(komus[-fragen][which((Entropietemp) == max((Entropietemp)))[1]]) == names(komus))[1])
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   modell[[i]] = fitting[[which((Entropietemp) == max((Entropietemp)))[1]]]
<span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (length(komus) == items) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp[items] = 0
<span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (j <span style="color: #00bfff;">in</span> 1:length(komus[-fragen])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[j]] = glm(reformulate(names(komus[fragen]), names(komus[-fragen][j])), data = komus, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chances = simplify2array(lapply(fitting, predict, komus[k,], type=<span style="color: #deb887;">"response"</span>))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp[length(fragen)] = sum(-chances*log(chances,2)-(1-chances)*log(1-chances,2))
<span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   chances = simplify2array(lapply(modell, predict, komus[k,], type=<span style="color: #deb887;">"response"</span>))
<span style="background-color: #252530;"> </span>   Entropietemp = (-chances*log(chances,2)-(1-chances)*log(1-chances,2))

<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">return</span>(c(Entropietemp, Restentropietemp))
})

Restentropietemp = (Entropieall[(items+1):(items*2),])
Entropieall = Entropieall[1:items,]
SumSDtemp = sd(Entropieall[1,])
<span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 2:length(Entropieall[,1])) {
SumSDtemp[i] = sd(colSums(Entropieall[1:i,]))
}

SumSD$indivbedsorttrenn = c(0,SumSDtemp )
EEE$indivbedsorttrenn = c(0,rowMeans(Entropieall))
RestEntropie$indivbedsorttrenn = c(0,rowMeans(Restentropietemp))
RestEntropieSD$indivbedsorttrenn = c(0,apply(Restentropietemp,1 ,sd))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-1-3-3" class="outline-5">
<h5 id="sec-2-1-3-3"><span class="section-number-5">2.1.3.3</span> Individuellbedingtsortierte Entropie mit Prädiktion</h5>
<div class="outline-text-5" id="text-2-1-3-3">
<p>
Hier wird nun die Entropie rekursiv berechnet. Es wird nicht nur geschaut, welches Item die meiste Entropie besitzt, sondern es werden für jedes Item alle
Antwortmöglichkeiten simuliert und mit dieser Simulation die verbleibende Entropie im gesamten Test
errechnet, diese mit der Chance der simulierten Antwort gewichtet und aufaddiert mit den gewichteten anderen Antwortmöglichkeiten.
</p>

<p>
Dieses Modell umgeht also das Problem der vorherigen beiden. Es ist sehr robust, weil immer auch berechnet wird, wie sehr sich das auserwählte Item mit all
seinen Antwortmöglichkeiten auf die gesamte Restentropie auswirkt. Dies ist eine mächtigere Form der Trennschärfe, weil sie nicht starr, sondern
antwortmusterspezifisch ist.
</p>

<p>
Dieses Modell bringt die rechnerischen Anforderungen auf ein neues Niveau, sie werden nochmals ungefähr 30 mal höher. Als Konsequenz daraus habe ich hier
eine Datenbank mit implementiert, die einerseits bereits berechnetes speichert um mir wiederholte Arbeit zu ersparen und andererseits stets schaut,
ob Frage-Antwort-Kombinationen bereits bei anderen Schülern vorgekommen ist, um mit Hilfe dieses Wissens hin und wieder einzelne Rechnungen zu ersparen.
</p>

<p>
Zunächst könnte man denken, dass es bei rund 50 binären Items \(2^{50}\) Möglichkeiten der Antwortmuster gibt, was die Datenbank als sinnlos erscheinen lässt.
Jedoch muss bedacht werden, dass die Antwort Reihenfolge in der aktuellen Regression keine Rolle spielt. Beantwortet man Item a, b, und c richtig und
bekommt daraufhin Item c, so würde man dies genauso bekommen, wenn man b, c und dann erst a richtig beantwortet, was die Sinnhaftigkeit der Datenbank
deutlich steigert. Zudem werden manche Antwortmuster und manche Items gehäuft vorkommen, weil sie entweder besonders qualitativ, oder besonders »normal« sind.
Im Moment fangen beispielsweise alle Schüler mit dem gleichen, maximal informativen Item an, weil noch keine Vorinformation über die Schüler vorhanden ist.
</p>
<div class="org-src-container">

<pre class="src src-R" id="statistic6"><span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">initializing</span>
<span style="background-color: #252530;"> </span>   fitting = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   Entropieall = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   chances = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   Restentropietemp = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   fragen = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   modell = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   Restentropietemp = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   multifragen = multifragenalt

<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">first item</span>
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 1:length(komusmult)) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (i %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[i]] = polr(reformulate(<span style="color: #deb887;">'1'</span>, names(komusmult[i])), data = komusmult)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[i]] = glm(reformulate(<span style="color: #deb887;">'1'</span>, names(komusmult[i])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   chances = fitting
<span style="background-color: #252530;"> </span>   chances[-multifragen] = lapply(fitting[-multifragen], predict, komusmult[1,], type=<span style="color: #deb887;">"response"</span>)
<span style="background-color: #252530;"> </span>   chances[multifragen] = lapply(fitting[multifragen], predict, komusmult[1,], type=<span style="color: #deb887;">"probs"</span>)
<span style="background-color: #252530;"> </span>   Entropietemp = FUN.Entropietemp.IND(chances)
<span style="background-color: #252530;"> </span>   fragen = which(names(komusmult[which(Entropietemp == max(Entropietemp))[1]]) == names(komusmult))[1]

<span style="background-color: #252530;"> </span>   modell[[1]] = fitting[[fragen]]
<span style="background-color: #252530;"> </span>   frageninit = fragen
<span style="background-color: #252530;"> </span>   fitting = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   Restentropie2 = <span style="color: #98f5ff;">NULL</span>

<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">multicore calculation</span>
<span style="background-color: #252530;"> </span>   Entropieall = simplify2array(foreach(k=1:persons) %dopar% {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fragen = frageninit
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropie = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp2 = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 2:items) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chances = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting2 = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fittingplus = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fittingminus = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp2 = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   multifragen = 0
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   multifragen = c(multifragen,which(names(komusmult[-fragen]) %<span style="color: #00bfff;">in</span>% names(komusmult[multifragenalt])))

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">prediction for all not-answerd questions</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (j <span style="color: #00bfff;">in</span> 1:length(komusmult[-fragen])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (j %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[j]] = polr(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[j]] = glm(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">prediction for all not-answered questions after prediction</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (length(komusmult[-fragen]) &gt; 1) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   multifragen2 = c(0,which(names(komusmult[-fragen][-j]) %<span style="color: #00bfff;">in</span>% names(komusmult[multifragenalt])))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (n <span style="color: #00bfff;">in</span> 1:length(komusmult[-fragen][-j])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (n %<span style="color: #00bfff;">in</span>% multifragen2) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting2[[n]] = polr(reformulate(names(c(komusmult[fragen], komusmult[-fragen][j])), names(komusmult[-fragen][-j][n])), data = komusmult)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting2[[n]] = glm(reformulate(names(c(komusmult[fragen], komusmult[-fragen][j])), names(komusmult[-fragen][-j][n])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">calculation of rest entropie for each possibility</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   tempdata = komusmult[k,]
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">##</span><span style="color: #7f7f7f;">tempdata[-fragen][j] = 0 #dies muss noch bearbeitet werden (chancen...)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>
<span style="color: #7f7f7f;">#                        </span><span style="color: #7f7f7f;">chances = fitting2</span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">if (length(multifragen2) == 1) {</span>
<span style="color: #7f7f7f;">#                        </span><span style="color: #7f7f7f;">chances = lapply(fitting2, predict, tempdata, type="response")</span>
<span style="color: #7f7f7f;">#                        </span><span style="color: #7f7f7f;">Entropietemp = chances</span>
<span style="color: #7f7f7f;">#                        </span><span style="color: #7f7f7f;">Entropietemp = lapply(chances, FUN.Entropie)</span>
<span style="color: #7f7f7f;">#                        </span><span style="color: #7f7f7f;">Entropietemp = simplify2array(Entropietemp)</span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">} else {</span>
<span style="color: #7f7f7f;">#                        </span><span style="color: #7f7f7f;">multifragen2 = multifragen2[2:length(multifragen2)]</span>
<span style="color: #7f7f7f;">#                        </span><span style="color: #7f7f7f;">chances[-multifragen2] = lapply(fitting2[-multifragen2], predict, tempdata, type="response")</span>
<span style="color: #7f7f7f;">#                        </span><span style="color: #7f7f7f;">chances[multifragen2] = lapply(fitting2[multifragen2], predict, tempdata, type="probs")</span>
<span style="color: #7f7f7f;">#                        </span><span style="color: #7f7f7f;">Entropietemp = chances</span>
<span style="color: #7f7f7f;">#                        </span>
<span style="color: #7f7f7f;">#                        </span><span style="color: #7f7f7f;">## Funktion kann nicht benutzt werden, da sie auf nicht manipulierte multifragen zugreift</span>
<span style="color: #7f7f7f;">#                        </span><span style="color: #7f7f7f;">Entropietemp[multifragen2] = lapply(chances[multifragen2], FUN.EntropieMC.IND)</span>
<span style="color: #7f7f7f;">#                        </span><span style="color: #7f7f7f;">Entropietemp[-multifragen2] = lapply(chances[-multifragen2], FUN.Entropie)</span>
<span style="color: #7f7f7f;">#                        </span><span style="color: #7f7f7f;">Entropietemp = simplify2array(Entropietemp)</span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">}</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = FUN.EntroMC(multifragen2,tempdata, fitting2)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp2[j] = sum(Entropietemp)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp2[j] = 0 
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chances = fitting

<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">## calculation of current rest entropie</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">if (length(multifragen) == 1) {</span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">chances = lapply(fitting, predict, komusmult[k,], type="response")</span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">Entropietemp = chances</span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">Entropietemp = lapply(chances, FUN.Entropie)</span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">Entropietemp = simplify2array(Entropietemp)</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">} else {</span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">multifragen = multifragen[2:length(multifragen)]</span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">chances[-multifragen] = lapply(fitting[-multifragen], predict, komusmult[k,], type="response")</span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">chances[multifragen] = lapply(fitting[multifragen], predict, komusmult[k,], type="probs")</span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">Entropietemp = chances</span>
<span style="color: #7f7f7f;">#                </span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">## Funktion kann nicht benutzt werden, da sie auf nicht manipulierte multifragen zugreift</span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">Entropietemp[multifragen] = lapply(chances[multifragen], FUN.EntropieMC.IND)</span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">Entropietemp[-multifragen] = lapply(chances[-multifragen], FUN.Entropie)</span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">Entropietemp = simplify2array(Entropietemp)</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">}</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = FUN.EntroMC(multifragen,komusmult[k,], fitting)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp[i-1] = sum(Entropietemp)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fragen = c(fragen, which(names(komusmult[-fragen][which(Restentropietemp2 == min(Restentropietemp2))[1]]) == names(komusmult))[1])
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">stimmt das? sollte das nicht mit Restentropietemp2 arbeiten?</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">##        </span><span style="color: #7f7f7f;">modell[[i]] = fitting[[which(Entropietemp == max(Entropietemp))]]</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   modell[[i]] = fitting[[which(Restentropietemp2 == min(Restentropietemp2))[1]]]
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">calculation of last rest entropie</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (length(komusmult) == items) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp[items] = 0
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   multifragen = 0
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   multifragen = c(0,which(names(komusmult[-fragen]) %<span style="color: #00bfff;">in</span>% names(komusmult[multifragenalt])))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (j <span style="color: #00bfff;">in</span> 1:length(komusmult[-fragen])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (j %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[j]] = polr(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[j]] = glm(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">if (length(multifragen) == 1) {</span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">chances = lapply(fitting, predict, komusmult[k,], type="response")</span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">Entropietemp = chances</span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">Entropietemp = lapply(chances, FUN.Entropie)</span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">Entropietemp = simplify2array(Entropietemp) </span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">} else {</span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">multifragen = multifragen[2:length(multifragen)]</span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">chances[-multifragen] = lapply(fitting[-multifragen], predict, komusmult[k,], type="response")</span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">chances[multifragen] = lapply(fitting[multifragen], predict, komusmult[k,], type="probs")</span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">Entropietemp = chances</span>
<span style="color: #7f7f7f;">#                    </span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">## Funktion kann nicht benutzt werden, da sie auf nicht manipulierte multifragen zugreift</span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">Entropietemp[multifragen] = lapply(chances[multifragen], FUN.EntropieMC.IND)</span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">Entropietemp[-multifragen] = lapply(chances[-multifragen], FUN.Entropie)</span>
<span style="color: #7f7f7f;">#                    </span><span style="color: #7f7f7f;">Entropietemp = simplify2array(Entropietemp)</span>
<span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">}</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = FUN.EntroMC(multifragen,komusmult[k,], fitting)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp[items] = sum(Entropietemp)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">calculation of choosen modell</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   multifragen = 0
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   multifragen = c(multifragen,which(fragen %<span style="color: #00bfff;">in</span>% multifragenalt))
<span style="color: #7f7f7f;">#        </span><span style="color: #7f7f7f;">if (length(multifragen) == 1) {</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">chances = modell</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">chances = lapply(modell, predict, komusmult[k,], type="response")</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">Entropietemp = chances</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">Entropietemp = lapply(chances, FUN.Entropie)</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">Entropietemp = simplify2array(Entropietemp)</span>
<span style="color: #7f7f7f;">#        </span><span style="color: #7f7f7f;">} else {</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">multifragen = multifragen[2:length(multifragen)]</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">chances = modell</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">chances[-multifragen] = lapply(modell[-multifragen], predict, komusmult[k,], type="response")</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">chances[multifragen] = lapply(modell[multifragen], predict, komusmult[k,], type="probs")</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">Entropietemp = chances</span>
<span style="color: #7f7f7f;">#            </span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">## Funktion kann nicht benutzt werden, da sie auf nicht manipulierte multifragen zugreift</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">Entropietemp[multifragen] = lapply(chances[multifragen], FUN.EntropieMC.IND)</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">Entropietemp[-multifragen] = lapply(chances[-multifragen], FUN.Entropie)</span>
<span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">Entropietemp = simplify2array(Entropietemp)</span>
<span style="color: #7f7f7f;">#        </span><span style="color: #7f7f7f;">}</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = FUN.EntroMC(multifragen,komusmult[k,], modell)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">return</span>(c(Entropietemp, Restentropietemp))<span style="background-color: #252530;"> </span>   
<span style="background-color: #252530;"> </span>   })

<span style="background-color: #252530;"> </span>   Restentropietemp = (Entropieall[(items+1):(items*2),])
<span style="background-color: #252530;"> </span>   Entropieall = Entropieall[1:items,]

<span style="background-color: #252530;"> </span>   SumSDtemp = sd(Entropieall[1,])
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 2:length(Entropieall[,1])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   SumSDtemp[i] = sd(colSums(Entropieall[1:i,]))
<span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   SumSD$indivbedsortpred = c(0,SumSDtemp)
<span style="background-color: #252530;"> </span>   EEE$indivbedsortpred = c(0,rowMeans(Entropieall))
<span style="background-color: #252530;"> </span>   RestEntropie$indivbedsortpred = c(0,rowMeans(Restentropietemp))
<span style="background-color: #252530;"> </span>   RestEntropieSD$indivbedsortpred = c(0,apply(Restentropietemp, 1, sd))

<span style="background-color: #252530;"> </span>   multifragen = multifragenalt
<span style="background-color: #252530;"> </span>   EEE
<span style="background-color: #252530;"> </span>   SumSD
<span style="background-color: #252530;"> </span>   RestEntropie
<span style="background-color: #252530;"> </span>   RestEntropieSD
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-2-1-4" class="outline-4">
<h4 id="sec-2-1-4"><span class="section-number-4">2.1.4</span> Experimenteller Code</h4>
<div class="outline-text-4" id="text-2-1-4">
<div class="org-src-container">

<pre class="src src-R"><span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    calculationtime <span style="color: #a2cd5a;">&lt;-</span> proc.time()

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">initializing</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fitting = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Entropieall = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    chances = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Restentropietemp = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fragen = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    modell = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Restentropietemp = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    multifragen = multifragenalt

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">first item</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 1:length(komusmult)) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">if</span> (i %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fitting[[i]] = polr(reformulate(<span style="color: #deb887;">'1'</span>, names(komusmult[i])), data = komusmult)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fitting[[i]] = glm(reformulate(<span style="color: #deb887;">'1'</span>, names(komusmult[i])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    chances = fitting
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    chances[-multifragen] = lapply(fitting[-multifragen], predict, komusmult[1,], type=<span style="color: #deb887;">"response"</span>)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    chances[multifragen] = lapply(fitting[multifragen], predict, komusmult[1,], type=<span style="color: #deb887;">"probs"</span>)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Entropietemp = FUN.Entropietemp.IND(chances)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fragen = which(names(komusmult[which(Entropietemp == max(Entropietemp))[1]]) == names(komusmult))[1]

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    modell[[1]] = fitting[[fragen]]
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    frageninit = fragen
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fitting = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Restentropie2 = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Entropieall = matrix(nrow=persons,ncol=items)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">multicore calculation</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#    </span><span style="color: #7f7f7f;">Entropieall = simplify2array(foreach(k=1:persons) %dopar% {</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">for</span> (k <span style="color: #00bfff;">in</span> 1:persons) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fragen = frageninit
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Restentropie = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Restentropietemp2 = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Restentropietemp = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    calcu = 0
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    calcutime = proc.time()
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    antwortmuster = vector(length=(length(komusmult)+2))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">if</span> (file.exists(<span style="color: #deb887;">'database.dat'</span>)) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    schongerechnet = read.table(<span style="color: #deb887;">'database.dat'</span>)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    antwortmuster[1] = fragen[1] + as.numeric(as.character(komusmult[k,fragen[1]]))/100
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">antwortmuster[2] = komusmult[k,fragen[1]]</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 2:items) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    chances = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Entropietemp = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fitting = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fitting2 = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fittingplus = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fittingminus = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Entropietemp2 = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    found = 0
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    multifragen = c(0,which(names(komusmult[-fragen]) %<span style="color: #00bfff;">in</span>% names(komusmult[multifragenalt])))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Liste = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    foundit = 0
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">prediction for all not-answerd questions</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">if</span> (exists(<span style="color: #deb887;">"schongerechnet"</span>)) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">for</span> (m <span style="color: #00bfff;">in</span> 1:length(schongerechnet[,1])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">for</span> (u <span style="color: #00bfff;">in</span> 1:length(fragen)) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">if</span> (sort(antwortmuster[1:length(fragen)])[u] != schongerechnet[m,u]) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">break</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">if</span> (schongerechnet[m,(length(fragen)+3)] == 0 &amp;&amp; u == length(fragen)) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    found = schongerechnet[m,(length(fragen)+2)]
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Restentropietemp[i-1] = schongerechnet[m,(length(fragen)+1)]
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fragen = c(fragen, found)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">if</span> (found != 0) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">break</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">if</span> (found == 0) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    calcu = calcu+1
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   isgood = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">for</span> (q <span style="color: #00bfff;">in</span> 1:length(komusmult[-fragen])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">if</span> (q %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fitting[[q]] = polr(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][q])), data = komusmult)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fitting[[q]] = glm(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][q])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = FUN.EntroMC(multifragen,komusmult[k,], fitting)
<span style="background-color: #252530;"> </span>   isgood = Entropietemp == max(Entropietemp)[1]


<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Liste =foreach(j=1:length(komusmult[-fragen])) %dopar% {
chance = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (j %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#    </span><span style="color: #7f7f7f;">fitting = polr(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chance = predict(fitting[[j]], komusmult[k,], type=<span style="color: #deb887;">"probs"</span>)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#                                                    </span><span style="color: #7f7f7f;">fitting = glm(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult, family = "binomial"(link=logit))</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chance = predict(fitting[[j]], komusmult[k,], type=<span style="color: #deb887;">"response"</span>)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   chance[2] = 1-chance[1]
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#                                             </span><span style="color: #7f7f7f;">Entropietemp = FUN.EntroMC(multifragen,komusmult[k,], fitting)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#      </span><span style="color: #7f7f7f;">tempdata = komusmult[k,]</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#          </span><span style="color: #7f7f7f;">if (j %in% multifragen) {</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#              </span><span style="color: #7f7f7f;">for (s in 1:length(chance)) {</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#                  </span><span style="color: #7f7f7f;">tempdata[-fragen][j] = factor(s-1) #dies muss noch bearbeitet werden (chancen...)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#                  </span><span style="color: #7f7f7f;">Entropietemp = FUN.EntroMC(multifragen,tempdata, fitting)*chance[s]</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#                  </span><span style="color: #7f7f7f;">Restentropietemp2[s] = sum(Entropietemp)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#              </span><span style="color: #7f7f7f;">}</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#              </span><span style="color: #7f7f7f;">Restentropietemp2 = sum(Restentropietemp2)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#          </span><span style="color: #7f7f7f;">} else {</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#              </span><span style="color: #7f7f7f;">tempdata[-fragen][j] = 1</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#              </span><span style="color: #7f7f7f;">Entropietemp = FUN.EntroMC(multifragen2,tempdata, fitting2)*chance[1]</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#              </span><span style="color: #7f7f7f;">Restentropietemp2 = sum(Entropietemp)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#              </span><span style="color: #7f7f7f;">tempdata[-fragen][j] = 0</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#              </span><span style="color: #7f7f7f;">Entropietemp = FUN.EntroMC(multifragen2,tempdata, fitting2)*chance[2]</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#              </span><span style="color: #7f7f7f;">Restentropietemp2[2] = sum(Entropietemp)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#              </span><span style="color: #7f7f7f;">Restentropietemp2 = sum(Restentropietemp2)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#          </span><span style="color: #7f7f7f;">}</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#          </span><span style="color: #7f7f7f;">fitting2=NULL</span>



<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Restentropietemp2 = <span style="color: #98f5ff;">NULL</span><span style="background-color: #252530;"> </span>      
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">prediction for all not-answered questions after prediction</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (length(komusmult[-fragen]) &gt; 1 &amp;&amp; isgood[j]) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   multifragen2 = c(0,which(names(komusmult[-fragen][-j]) %<span style="color: #00bfff;">in</span>% names(komusmult[multifragenalt])))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (n <span style="color: #00bfff;">in</span> 1:length(komusmult[-fragen][-j])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (n %<span style="color: #00bfff;">in</span>% multifragen2) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting2[[n]] = polr(reformulate(names(c(komusmult[fragen], komusmult[-fragen][j])), names(komusmult[-fragen][-j][n])), data = komusmult)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting2[[n]] = glm(reformulate(names(c(komusmult[fragen], komusmult[-fragen][j])), names(komusmult[-fragen][-j][n])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">calculation of rest entropie for each possibility</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   tempdata = komusmult[k,]
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (j %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">for (s in 1:length(chance)) {</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">tempdata[-fragen][j] = factor(s-1) #dies muss noch bearbeitet werden (chancen...)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">Entropietemp = FUN.EntroMC(multifragen2,tempdata, fitting2)*chance[s]</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#                </span><span style="color: #7f7f7f;">Restentropietemp2[s] = sum(Entropietemp)</span>
<span style="color: #7f7f7f;">#                                                            </span><span style="color: #7f7f7f;">}</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#            </span><span style="color: #7f7f7f;">Restentropietemp2 = sum(Restentropietemp2)</span>
Entropietemp = FUN.EntroMC(multifragen2,tempdata, fitting2)
Restentropietemp2 = sum(Entropietemp)

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   tempdata[-fragen][j] = 1
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = FUN.EntroMC(multifragen2,tempdata, fitting2)*chance[1]
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp2 = sum(Entropietemp)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   tempdata[-fragen][j] = 0
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Entropietemp = FUN.EntroMC(multifragen2,tempdata, fitting2)*chance[2]
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp2[2] = sum(Entropietemp)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp2 = sum(Restentropietemp2)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting2=<span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> { 
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (isgood[j]) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp2 = 0 
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   Restentropietemp2 = 55555555
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">return</span>(Restentropietemp2)   
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   }


<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#                                             </span><span style="color: #7f7f7f;">Liste = unlist(Liste, recursive = FALSE)</span>
<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#                                             </span>
<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#                                             </span><span style="color: #7f7f7f;">Restentropietemp2 = unlist(Liste[(1:(length(Liste)/2))*2])</span>
<span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;">#                                             </span><span style="color: #7f7f7f;">fitting = Liste[(1:(length(Liste)/2))*2-1]</span>
<span style="background-color: #252530;"> </span>    Restentropietemp2 = simplify2array(Liste)<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fragen = c(fragen, which(names(komusmult[-fragen][which(Restentropietemp2 == min(Restentropietemp2))[1]]) == names(komusmult))[1])
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    modell[[i]] = fitting[[which(Restentropietemp2 == min(Restentropietemp2))[1]]]


<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    chances = fitting

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Entropietemp = FUN.EntroMC(multifragen,komusmult[k,], fitting)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Restentropietemp[i-1] = sum(Entropietemp)

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    } 
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    antwortmuster[i] = fragen[i] + as.numeric(as.character(komusmult[k,fragen[i]]))/100

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">if</span> (found == 0) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    temp = antwortmuster
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    temp[1:(i-1)] = sort(antwortmuster[1:(i-1)])
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    temp[i] = Restentropietemp[i-1]
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    temp[i+1] = fragen[i]
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    write(temp, file=<span style="color: #deb887;">'database.dat'</span>, append=<span style="color: #98f5ff;">TRUE</span>, ncolumns=length(antwortmuster))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    plot(Restentropietemp, type=<span style="color: #deb887;">'l'</span>, col=rgb(0,0.7,0.7))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">calculation of last rest entropie</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">if</span> (length(komusmult) == items) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Restentropietemp[items] = 0
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fitting = <span style="color: #98f5ff;">NULL</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    multifragen = 0
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    multifragen = c(0,which(names(komusmult[-fragen]) %<span style="color: #00bfff;">in</span>% names(komusmult[multifragenalt])))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">for</span> (j <span style="color: #00bfff;">in</span> 1:length(komusmult[-fragen])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">if</span> (j %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fitting[[j]] = polr(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    fitting[[j]] = glm(reformulate(names(komusmult[fragen]), names(komusmult[-fragen][j])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Entropietemp = FUN.EntroMC(multifragen,komusmult[k,], fitting)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Restentropietemp[items] = sum(Entropietemp)
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">## </span><span style="color: #7f7f7f;">calculation of choosen modell</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    multifragen = 0
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    multifragen = c(multifragen,which(fragen %<span style="color: #00bfff;">in</span>% multifragenalt))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #00bfff;">if</span> (calcu != 0) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    temp = vector(length=(length(komusmult)+2))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    temp[2] = k
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    temp[3] = (proc.time() - calcutime)[3]
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    temp[4] = calcu
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    write(temp, file=<span style="color: #deb887;">'database.dat'</span>, append=<span style="color: #98f5ff;">TRUE</span>, ncolumns=length(antwortmuster))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">Entropietemp = FUN.EntroMC(multifragen,komusmult[k,], modell)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#    </span><span style="color: #7f7f7f;">return(c(Entropietemp, Restentropietemp))</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    Entropieall[k,] = Restentropietemp
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    }<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">})</span>

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">Restentropietemp = (Entropieall[(items+1):(items*2),])</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">Entropieall = Entropieall[1:items,]</span>

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#    </span><span style="color: #7f7f7f;">SumSDtemp = sd(Entropieall[1,])</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>     <span style="color: #7f7f7f;">#   </span><span style="color: #7f7f7f;">for (i in 2:length(Entropieall[,1])) {</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>      <span style="color: #7f7f7f;">#      </span><span style="color: #7f7f7f;">SumSDtemp[i] = sd(colSums(Entropieall[1:i,]))</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="color: #7f7f7f;"># </span><span style="color: #7f7f7f;">}</span>

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">SumSD$indivbedsortpred = c(0,SumSDtemp)</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">EEE$indivbedsortpred = c(0,rowMeans(Entropieall))</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    RestEntropie$indivbedsortpred = c(0,colMeans(Entropieall))
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    RestEntropieSD$indivbedsortpred = c(0,apply(Entropieall, 2, sd))

<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    multifragen = multifragenalt
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">EEE</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    <span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">SumSD</span>
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    RestEntropie
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>    RestEntropieSD
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-1-5" class="outline-4">
<h4 id="sec-2-1-5"><span class="section-number-4">2.1.5</span> Schlussberechnungen</h4>
<div class="outline-text-4" id="text-2-1-5">
<p>
Hier werden lediglich ein paar Aufräumarbeiten in den Daten noch erledigt, um diese dann gut zeichnen zu können.
</p>
<div class="org-src-container">

<pre class="src src-R" id="statisticend"><span style="color: #00bfff;">if</span> (names(EEE[1]) == <span style="color: #deb887;">'kill'</span>) {
<span style="background-color: #252530;"> </span>   EEE = EEE[-1]
}

<span style="color: #00bfff;">if</span> (names(SumSD[1]) == <span style="color: #deb887;">'kill'</span>) {
<span style="background-color: #252530;"> </span>   SumSD = SumSD[-1]
}

<span style="color: #00bfff;">if</span> (names(RestEntropie[1]) == <span style="color: #deb887;">'kill'</span>) {
<span style="background-color: #252530;"> </span>   RestEntropie = RestEntropie[-1]
<span style="background-color: #252530;"> </span>   RestEntropieSD = RestEntropieSD[-1]
}

<span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 1:length(EEE[1,])) {
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">for</span> (j <span style="color: #00bfff;">in</span> 1:length(EEE[,1])) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   summe[j,i] = sum(EEE[1:j,i])
<span style="background-color: #252530;"> </span>   }
}

fitting = <span style="color: #98f5ff;">NULL</span>
multifragen = multifragenalt
<span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 1:length(komusmult)) {
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (i %<span style="color: #00bfff;">in</span>% multifragen) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[i]] = polr(reformulate(<span style="color: #deb887;">'1'</span>, names(komusmult[i])), data = komusmult)
<span style="background-color: #252530;"> </span>   } <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   fitting[[i]] = glm(reformulate(<span style="color: #deb887;">'1'</span>, names(komusmult[i])), data = komusmult, family = <span style="color: #deb887;">"binomial"</span>(link=logit))
<span style="background-color: #252530;"> </span>   }
}

chances = fitting
chances[-multifragen] = lapply(fitting[-multifragen], predict, komusmult[1,], type=<span style="color: #deb887;">"response"</span>)
chances[multifragen] = lapply(fitting[multifragen], predict, komusmult[1,], type=<span style="color: #deb887;">"probs"</span>)
Entropietemp = FUN.Entropietemp.IND(chances)
RestEntropie[1,] = sum(Entropietemp)

names(summe) = names(EEE)

<span style="color: #00bfff;">if</span> (exists(<span style="color: #deb887;">"benchmark"</span>)) {
<span style="background-color: #252530;"> </span>   benchmark = array(c(benchmark,(proc.time() - calculationtime)[3]))
} <span style="color: #00bfff;">else</span> {
<span style="background-color: #252530;"> </span>   benchmark = (proc.time() - calculationtime)[3]
}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-1-6" class="outline-4">
<h4 id="sec-2-1-6"><span class="section-number-4">2.1.6</span> Formel für die Modellanpassung</h4>
<div class="outline-text-4" id="text-2-1-6">
<p>
Hier kann noch bestimmt werden, ob die binärlogistischen Regressionen noch schlechte Items verwerfen, oder einfach mit allen rechnen.
Änderungen, die hier gemacht werden, werden automatisch im gesamten Code angepasst, da dieser Teil mit noweb-syntax eingebunden ist.
</p>

<p>
Aus statistischer Sicht ist es natürlich viel besser, wenn schlechte Items noch verworfen und noch Interaktionen hinzugefügt werden. 
Was hier aber dagegen spricht, ist die dadurch resultierende Berechnungsdauer.
So sind selbst die einfacheren obigen Modell auch nach Stunden nicht fertig.
</p>
<div class="org-src-container">

<pre class="src src-R" id="fitting"><span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, trace = 0)</span>
<span style="color: #7f7f7f;">#</span><span style="color: #7f7f7f;">fitting = mclapply(fitting, step, ~.^2, trace = 0)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-1-7" class="outline-4">
<h4 id="sec-2-1-7"><span class="section-number-4">2.1.7</span> Benchmark</h4>
<div class="outline-text-4" id="text-2-1-7">
<div class="org-src-container">

<pre class="src src-R">plot(benchmark, type=<span style="color: #deb887;">"l"</span>, col=rgb(0,0,0), ann=F)
title(xlab=<span style="color: #deb887;">"Durchlauf"</span>)
title(ylab=<span style="color: #deb887;">"Dauer"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-1-8" class="outline-4">
<h4 id="sec-2-1-8"><span class="section-number-4">2.1.8</span> Entropiegrafik</h4>
<div class="outline-text-4" id="text-2-1-8">
<p>
Hier ist noch ein letztes kleines Bisschen an Code, welches die derzeit kalkulierten Ergebnisse in eine Grafik packt. Zudem werden
eine Legende generiert und die Berechnungsdauer angegeben.
</p>
<div class="org-src-container">

<pre class="src src-R" id="grafik">farbe = <span style="color: #98f5ff;">NULL</span>
farbeSD = <span style="color: #98f5ff;">NULL</span>
<span style="color: #00bfff;">for</span> (j <span style="color: #00bfff;">in</span> 1:(length(summe[1,]))) {
<span style="background-color: #252530;"> </span>   r = runif(1,0.1,0.9)
<span style="background-color: #252530;"> </span>   g = runif(1,0.1,0.9)
<span style="background-color: #252530;"> </span>   b = runif(1,0.1,0.9)
<span style="background-color: #252530;"> </span>   farbe[j] = rgb(r^1.2, g^1.2, b^1.2)
<span style="background-color: #252530;"> </span>   farbeSD[j] = rgb(sqrt(r), sqrt(g), sqrt(b))
}

plot(0:(length(komusmult)), type=<span style="color: #deb887;">"l"</span>, col=rgb(0,0,0), ann=F)
<span style="color: #00bfff;">for</span> (i <span style="color: #00bfff;">in</span> 1:(length(summe[1,]))) {
<span style="background-color: #252530;"> </span>   lines(summe[,i], col=farbe[i])
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (dim(SumSD[names(SumSD) == names(summe[i])])[2] != 0) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   lines(summe[,i]+SumSD[names(summe[i])],lty = 4, col=farbeSD[i])
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   lines(summe[,i]-SumSD[names(summe[i])],lty = 4, col=farbeSD[i])
<span style="background-color: #252530;"> </span>   }
<span style="background-color: #252530;"> </span>   <span style="color: #00bfff;">if</span> (dim(RestEntropie[names(RestEntropie) == names(summe[i])])[2] != 0) {
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   lines(RestEntropie[names(summe[i])], col=farbe[i])
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   lines(RestEntropie[names(summe[i])]+RestEntropieSD[names(summe[i])],lty = 4, col=farbeSD[i])
<span style="background-color: #252530;"> </span>   <span style="background-color: #252530;"> </span>   lines(RestEntropie[names(summe[i])]-RestEntropieSD[names(summe[i])],lty = 4, col=farbeSD[i])
<span style="background-color: #252530;"> </span>   }
}

title(xlab=<span style="color: #deb887;">"Anzahl der beantworteten Fragen"</span>)
title(ylab=<span style="color: #deb887;">"Entropie in bit"</span>)
legend(length(komusmult)/4, length(komusmult), c(names(summe), round(benchmark[length(benchmark)])), cex=0.9, col=c(farbe, rgb(1,1,1)), lty=1);
</pre>
</div>
</div>
</div>
</div>
</div>
